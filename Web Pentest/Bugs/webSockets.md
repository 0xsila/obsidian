- To establish the connection, the browser and server perform a WebSocket handshake over HTTP.

- The browser issues a WebSocket handshake request like the following: 
 GET /chat HTTP/1.1
 Host: normal-website.com
 Sec-WebSocket-Version: 13
 Sec-WebSocket-Key: wDqumtseNBJdhkihL6PW7w==
 Connection: keep-alive, Upgrade
 Cookie: session=KOsEJNuflw4Rd9BDNrVmvwBF9rEijeE2
 Upgrade: websocket

 If the server accepts the connection, it returns a WebSocket handshake response like the following: 
 
 HTTP/1.1 101 Switching Protocols
 Connection: Upgrade
 Upgrade: websocket
 Sec-WebSocket-Accept: 0FFP+2nmNIf/h+4BP36k9uzrYGk= 

- Several features of the WebSocket handshake messages are worth noting:

* The Connection and Upgrade headers in the request and response indicate that this is a WebSocket handshake.
* The Sec-WebSocket-Version request header specifies the WebSocket protocol version that the client wishes to use. This is typically 13.
* The Sec-WebSocket-Key request header contains a Base64-encoded random value, which should be randomly generated in each handshake request.
* The Sec-WebSocket-Accept response header contains a hash of the value submitted in the Sec-WebSocket-Key request header, 
  concatenated with a specific string defined in the protocol specification. This is done to prevent misleading responses resulting from misconfigured servers or caching proxies.

# what you can do : 

- Intercept and modify WebSocket messages.
- Replay and generate new WebSocket messages.
- Manipulate WebSocket connections : 

   Misplaced trust in HTTP headers to perform security decisions, such as the X-Forwarded-For header.
   Flaws in session handling mechanisms, since the session context in which WebSocket messages are processed is generally determined by the session context of the handshake message.
   Attack surface introduced by custom HTTP headers used by the application.


# idea : 

if they block you and you can't reconnect in websocket , use X-Forwarded-For: 1.1.1.1 header to reconnect .

+csrf : waw 