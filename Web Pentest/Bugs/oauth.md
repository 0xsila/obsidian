
### Oauth basics : 

user ----> target.c/auth 
user <----- redirect : auth.c/?cliednt_id=targetapp&redirect_uri=https//target.c/cb
				 &state=xxsjjsjdhdhdhdh
				 &response_type=code
                

user ------> auth.c/?cliednt_id=targetapp&redirect_uri=https//target.c/cb
				 &state=xxsjjsjdhdhdhdh
				 &response_type=code

user <-------- redirect : target.c/cb?code=djjdjdjjdkdkdk
                     &state=xxsjjsjdhdhdhdh

user ----------> target.c/cb?code=djjdjdjjdkdkdk
                     &state=xxsjjsjdhdhdhdh

user <--------- set-cookie : session = helloworld

---
#### state : 

- like csrf token
###### - login csrf : 
send this request , with problem in the state parameter : 
user ----------> target.c/cb?code=djjdjdjjdkdkdk
                     &state=xxsjjsjdhdhdhdh

- remove it
- random value
-  value from another account

find an impact , maybe some integration with google caleneder , and you will access to the victim google calender , now it is serious bug .

###### - link the account :
now , it is very serious bug .

do the work until the needed request , drop the request . 
send it to the victim


---

#### redirect_uri : 

in the 2 nd request : 

user ------> auth.c/?cliednt_id=targetapp&redirect_uri=https//attacker.com/cb
				 &state=xxsjjsjdhdhdhdh
				 &response_type=code



but is not that easy

- try bypass the whitelist
- try open redirect bugs : 
	- target.com.attacker.com
	- //attcker.com
	- https//attacker.com\\\@target.com
	- https//attacker.com?@target.c
	- attacker.com%0d%0atarget.com

or find a openredirect in the website and use it .


---

#### Prompt : 

default value = consent or choosing email

change it to : prompt=none to minimise interaction


---
#### response_mode : 

default value = query

another values : 
- fragment : #code= : if we change it from query to fragment , the code will leak in the url , now you need to chain it with another bug to be impactful . the fragment isn't sent to the server in HTTP requests â€” only available in the browser.

 - form_post : **Returns parameters in**: an **HTML form POST body**.
      exemple : 
      <form method="post" action="https://client.com/callback">
		  <input name="code" value="AUTH_CODE">
		  <input name="state" value="xyz">
		</form>


 - web_message : 























---


code parameter : 1 time used

oauth : open authentication 
3 parameter : 
redirectutl=
token=
state=

lead to csrf , ato

scenario of csrf : 
if no state token (like csrf token )
intersept the request when facebook or anything send the token for the website and copy it and drope it
send the link to the victim : the token will be connected to the victim account
bom bug


-----------------------------------------

open redirect : 

redirecturl= this parameter if it is vulnerable , the bug is from google or facebook

but , if you find an open redirect in the website , and write the vulnerable url in the parameter => ATO

-----------------------------------------
# Oauth grant type ( Oauth flaws ) : 
There are several different grant types, each with varying levels of complexity and security considerations. We'll focus on the "authorization code" and "implicit" grant types as these are by far the most common.

# the bugs : 

## Improper implementation of the implicit grant type ( implicit flow ) :

easy beasy , the client app recieve the secret key or the data (like email ) , 
after that a POST request login using the data or the secret key , if it easy , change it to another user 

## Flawed CSRF protection : 

if no state parameter , maybe we have csrf , you need to understand the target ,
the request is change , just understand

## OAuth account hijacking via redirect_uri : 

no validation in the redirect url parameter





------------------------------------------

https://github.com/HolyBugx/HolyTips/blob/main/Checklist/OAuth.md

