
1. katana -u subdomainsList -em pdf,docx | tee endpointsPDF_DOC
2. grep -i 'redacted.*\.pdf$' endpointsPDF_DOC | sed -E 's/[-_]?redacted//gi' | sort -u | httpx -mc 200 -sc

𝐇𝐨𝐰 𝐭𝐨 𝐛𝐲𝐩𝐚𝐬𝐬 "𝐔𝐧𝐚𝐮𝐭𝐡𝐨𝐫𝐢𝐳𝐞𝐝 - 403" 👇

If you stumbled upon a "403 Forbidden" page ->chances are there is something juicy that developers try to protect 

--- 1. 𝐑𝐞𝐦𝐨𝐯𝐞 𝐭𝐡𝐞 𝐇𝐨𝐬𝐭 𝐇𝐞𝐚𝐝𝐞𝐫 --- 

By removing the Host header from the request, some servers may return a redirect Location header (see screenshot)

This location could be the actual address of the application behind the firewall which (when accessed directly) let's you bypass the 403

--- 2. 𝐂𝐡𝐚𝐧𝐠𝐞 𝐭𝐡𝐞 𝐋𝐞𝐭𝐭𝐞𝐫 𝐂𝐚𝐬𝐞 --- 

/admin -> 403 Forbidden
/AdMiN -> 200 OK

--- 3. 𝐀𝐥𝐭𝐞𝐫𝐧𝐚𝐭𝐞 𝐇𝐓𝐓𝐏 𝐕𝐞𝐫𝐬𝐢𝐨𝐧𝐬 --- 

HTTP/0.9
HTTP/1.1
HTTP/3

--- 4. 𝐇𝐓𝐓𝐏 𝐌𝐞𝐭𝐡𝐨𝐝 𝐅𝐮𝐳𝐳𝐢𝐧𝐠 --- 

GET /admin HTTP/1.1 -> 403 Forbidden
POST /admin HTTP/1.1 -> 403 Forbidden
PUT /admin HTTP/1.1 -> 403 Forbidden
PATCH /admin HTTP/1.1 -> 200 OK

--- 5. 𝐔𝐬𝐞𝐫-𝐀𝐠𝐞𝐧𝐭 𝐅𝐮𝐳𝐳𝐢𝐧𝐠 --- 

GET /admin HTTP/1.1
Host: target
User-Agent: <INTRUDER_INJECTION>

--- 6. 𝐏𝐚𝐭𝐡 𝐅𝐮𝐳𝐳𝐢𝐧𝐠 ---

Trick the URL parser into thinking you are trying to access another page (one that should not be protected

target[.]com/admin/?
target[.]com//admin//
target[.]com///admin///

--- 7. 𝐇𝐓𝐓𝐏 𝐇𝐞𝐚𝐝𝐞𝐫 𝐅𝐮𝐳𝐳𝐢𝐧𝐠 ---

Lastly (and the most popular technique) involves adding headers such as HTTP-X-FORWARDED-FOR-IP to the request. 

Based on how the application/server is configured, it might interpret the request as coming from localhost and disable some of the security measures as it implies this is a safe place

--- 8. Response manipulation  ---

in login reqeust to privlege escalution : try it
in reset password or any authentication : change status code to 200

--- 9. force browsing ---
https://0xsila/login => https://0xsila/test
try to go directly to : https://0xsila/test

and in files : https://0xsila/file.txt (normal case if you logged in)
try without login browse to : https://0xsila/file.txt

--- reset password to account takeover --- 
========================================
go to reset password function
write your cuurent email to get true link
if the email is in the link of reset password
do not click it and chnage the email to the victime email
write letter by letter the link in browser 
boom account takeover
========================================

login with current email
open another browser and send forget password request usnig old email (the current)
do not use the link , just copy coller in gedit
go to account and change email to new email
check if you can change password using the old link

=========================================

click to reset password 
you will get a reset link in email
reclick to reset password
you will get new reset link in email

if they work bin zoudj , booom bug

-security impact : 
-- broken authentication : the system fails to invalidate previous reset links , allowing attackers to use old links to reset password , even new request is made .
-- unauthorized access : an attacker who hasgained accesss to an old reset link can exploit this flaw to take over the account, bypassing the intended security measures.

==========================================
go to reset password or forget password and tap the victime email@ : 
intercept the request , do an array that have 2 emails : 
[victime@gmail.com , attacker@gmail.com ]
or try http parameter polution : 
email=victime@gmail.com&email=attacker@gmail.com

boom , account takeover

==========================================

if an link is sended to the victim in reset password function , 
try to intercept the request and change the link to attcker.com

bom bug

=========================================

very stuped things 

send the request of reset password to repeter
send the request
the token in the response 
hhhhhhhhhhhhhhhhhhhhhhhhh bom account takeover

=============================================

tap the victim email @ in forget password 
intercept the request 
send it normal in the first time
change now the email ( in the request ) to attacker @

bom account takeover
============================================

if yoy find 404 files , check old version of the website



